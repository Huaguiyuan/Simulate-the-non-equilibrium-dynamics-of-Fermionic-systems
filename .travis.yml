language: cpp

matrix:
  include:
    - os: linux
      compiler: gcc
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['gcc-4.9', 'g++-4.9']
      env:
        - COMPILER_CC=gcc-4.9
        - COMPILER_CXX=g++-4.9

    - os: linux
      compiler: gcc
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['gcc-5', 'g++-5']
      env:
        - COMPILER_CC=gcc-5
        - COMPILER_CXX=g++-5

    - os: linux
      compiler: gcc
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['gcc-6', 'g++-6']
      env:
        - COMPILER_CC=gcc-6
        - COMPILER_CXX=g++-6

    - os: linux
      compiler: clang
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test', 'llvm-toolchain-precise-3.5']
          packages: ['clang-3.5']
      env:
        - COMPILER_CC=clang-3.5
        - COMPILER_CXX=clang++-3.5

    - os: linux
      compiler: clang
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test', 'llvm-toolchain-precise-3.6']
          packages: ['clang-3.6']
      env:
        - COMPILER_CC=clang-3.6
        - COMPILER_CXX=clang++-3.6

    - os: linux
      compiler: clang
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test', 'llvm-toolchain-precise-3.7']
          packages: ['clang-3.7']
      env:
        - COMPILER_CC=clang-3.7
        - COMPILER_CXX=clang++-3.7

    - os: linux
      compiler: clang
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test', 'llvm-toolchain-precise-3.8']
          packages: ['clang-3.8']
      env:
        - COMPILER_CC=clang-3.8
        - COMPILER_CXX=clang++-3.8

    - os: osx
      compiler: clang
      env:
        - COMPILER_CC=clang
        - COMPILER_CXX=clang++

    - os: osx
      osx_image: xcode6.4
      compiler: clang
      env:
        - COMPILER_CC=clang
        - COMPILER_CXX=clang++

    - os: osx
      osx_image: xcode7
      compiler: clang
      env:
        - COMPILER_CC=clang
        - COMPILER_CXX=clang++

    - os: osx
      osx_image: xcode7.1
      compiler: clang
      env:
        - COMPILER_CC=clang
        - COMPILER_CXX=clang++

    - os: osx
      osx_image: xcode7.2
      compiler: clang
      env:
        - COMPILER_CC=clang
        - COMPILER_CXX=clang++

    - os: osx
      osx_image: xcode7.3
      compiler: clang
      env:
        - COMPILER_CC=clang
        - COMPILER_CXX=clang++

install:
  - if [[ "$TRAVIS_OS_NAME" != "osx" ]]; then tools/travis-cmake.sh; fi
  - if [[ "$TRAVIS_OS_NAME" != "osx" ]]; then export PATH="$PWD/cmake-3.5.2/dist/bin:$PATH"; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install --force cmake; fi

script:
  - mkdir build
  - cd build
  - CXX=$COMPILER_CXX CC=$COMPILER_CC cmake ..
  - make -j$(nproc)
